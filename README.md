<div align="center">

![](Whisk_8e08477062d01b09a5d49509d124cd89dr.jpeg)

# ğŸ¤– Slack GAS Simple Bot

**Google Apps Scriptã§ã‚·ãƒ³ãƒ—ãƒ«ãªSlackãƒœãƒƒãƒˆã‚’æ§‹ç¯‰**

<p align="center">
  <img src="https://img.shields.io/badge/Google%20Apps%20Script-4285F4?style=for-the-badge&logo=google&logoColor=white" alt="Google Apps Script">
  <img src="https://img.shields.io/badge/Slack-4A154B?style=for-the-badge&logo=slack&logoColor=white" alt="Slack">
  <img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black" alt="JavaScript">
</p>

</div>

---

## ğŸ“‹ æ¦‚è¦

`slack-gas-simple-bot` ã¯ã€Google Apps Script (GAS) ã‚’ä½¿ç”¨ã—ã¦æ§‹ç¯‰ã•ã‚ŒãŸã‚·ãƒ³ãƒ—ãƒ«ãªSlackãƒœãƒƒãƒˆã§ã™ã€‚Slack Events APIã¨é€£æºã—ã€ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ï¼ˆ`@bot_name`ï¼‰ã«åå¿œã—ã¦åŸºæœ¬çš„ãªã‚³ãƒãƒ³ãƒ‰ã‚’å‡¦ç†ã—ã¾ã™ã€‚

ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ã§å‹•ä½œã—ã€Googleã®ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ä¸Šã§ãƒ›ã‚¹ãƒˆã•ã‚Œã‚‹ãŸã‚ã€ç‹¬è‡ªã®ã‚µãƒ¼ãƒãƒ¼ã‚’ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã€‚

## âœ¨ ç‰¹å¾´

- ğŸš€ **ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹**: Google Apps Scriptã§å‹•ä½œã™ã‚‹ãŸã‚ã€ã‚µãƒ¼ãƒãƒ¼ç®¡ç†ä¸è¦
- ğŸ’¬ **ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³å¯¾å¿œ**: Slackãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹å†…ã§ãƒœãƒƒãƒˆã«ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã™ã‚‹ã¨åå¿œ
- ğŸ¯ **ã‚·ãƒ³ãƒ—ãƒ«ãªã‚³ãƒãƒ³ãƒ‰**: hello, help, timeãªã©ã®åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚µãƒãƒ¼ãƒˆ
- ğŸ”„ **ã‚ªã‚¦ãƒ è¿”ã—æ©Ÿèƒ½**: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä»¥å¤–ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãã®ã¾ã¾è¿”ã™
- ğŸ” **ã‚»ã‚­ãƒ¥ã‚¢ãªè¨­å®š**: ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä½¿ç”¨ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†
- âš¡ **ç°¡å˜ãƒ‡ãƒ—ãƒ­ã‚¤**: GASã®Webã‚¢ãƒ—ãƒªã¨ã—ã¦ç°¡å˜ã«ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| æŠ€è¡“ | ç”¨é€” |
|------|------|
| Google Apps Script | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ |
| Slack Events API | Slackã¨ã®é€£æº |
| Slack Bot Token | APIèªè¨¼ |

## ğŸ“¦ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †

### 1. Google Apps Scriptãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

1. [Google Apps Script](https://script.google.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€Œæ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’ `slack-gas-simple-bot` ã«è¨­å®š

### 2. ã‚³ãƒ¼ãƒ‰ã®é…ç½®

1. `code.gs` ãƒ•ã‚¡ã‚¤ãƒ«ã«ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã® `code.gs` ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼
2. `appsscript.json` ã®è¨­å®šã‚’ç¢ºèªãƒ»é©ç”¨

### 3. Slack Appã®ä½œæˆã¨è¨­å®š

#### 3.1 Slack Appã®ä½œæˆ

1. [Slack API](https://api.slack.com/apps) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒCreate New Appã€â†’ã€ŒFrom scratchã€ã‚’é¸æŠ
3. Appåã¨ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’æŒ‡å®šã—ã¦ä½œæˆ

#### 3.2 Bot Token Scopesã®è¨­å®š

ã€ŒOAuth & Permissionsã€ãƒšãƒ¼ã‚¸ã§ä»¥ä¸‹ã®ã‚¹ã‚³ãƒ¼ãƒ—ã‚’è¿½åŠ ï¼š

- `app_mentions:read` - ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã‚’èª­ã¿å–ã‚‹
- `chat:write` - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹

#### 3.3 Bot Tokenã®å–å¾—

1. ã€ŒOAuth & Permissionsã€ãƒšãƒ¼ã‚¸ã§ã€ŒInstall to Workspaceã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. æ‰¿èªå¾Œã€`Bot User OAuth Token`ï¼ˆ`xoxb-` ã§å§‹ã¾ã‚‹ï¼‰ã‚’ã‚³ãƒ”ãƒ¼

### 4. GASã§Webã‚¢ãƒ—ãƒªã‚’ãƒ‡ãƒ—ãƒ­ã‚¤

1. GASã‚¨ãƒ‡ã‚£ã‚¿ã§ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’é¸æŠ
2. ã€Œç¨®é¡ã®é¸æŠã€ã§ã€Œã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã€ã‚’é¸æŠ
3. ä»¥ä¸‹ã®è¨­å®šã‚’è¡Œã†ï¼š
   - **èª¬æ˜**: ä»»æ„ã®èª¬æ˜ï¼ˆä¾‹: "v1.0"ï¼‰
   - **å®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ãƒ¼**: è‡ªåˆ†
   - **ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼**: å…¨å“¡
4. ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€**ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URL**ã‚’ã‚³ãƒ”ãƒ¼

### 5. GASã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®š

1. GASã‚¨ãƒ‡ã‚£ã‚¿ã§ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šã€ï¼ˆâš™ã‚¢ã‚¤ã‚³ãƒ³ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€ã‚¿ãƒ–ã§ä»¥ä¸‹ã‚’è¿½åŠ ï¼š

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å | å€¤ |
|-------------|-----|
| `SLACK_BOT_TOKEN` | `xoxb-` ã§å§‹ã¾ã‚‹Bot User OAuth Token |
| `WEBHOOK_SECRET` | ï¼ˆä»»æ„ï¼‰ç½²åæ¤œè¨¼ç”¨ã®Signing Secret |

### 6. Slack Event Subscriptionsã®è¨­å®š

1. Slack Appã®è¨­å®šãƒšãƒ¼ã‚¸ã§ã€ŒEvent Subscriptionsã€ã‚’é–‹ã
2. ã€ŒEnable Eventsã€ã‚’ã‚ªãƒ³ã«ã™ã‚‹
3. **Request URL**ã«GASã®ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªURLã‚’å…¥åŠ›
4. URLæ¤œè¨¼ãŒæˆåŠŸã—ãŸã‚‰ã€ã€ŒSubscribe to bot eventsã€ã§ä»¥ä¸‹ã‚’è¿½åŠ ï¼š
   - `app_mention` - ãƒœãƒƒãƒˆãŒãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã•ã‚ŒãŸã¨ã
5. ã€ŒSave Changesã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### 7. ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

å¤‰æ›´ã‚’ä¿å­˜ã—ãŸå¾Œã€å¿…è¦ã«å¿œã˜ã¦Slack Appã‚’ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

## ğŸš€ ä½¿ç”¨æ–¹æ³•

Slackãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹å†…ã§ã€ãƒœãƒƒãƒˆã‚’ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã—ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã™ï¼š

```
@bot_name hello
@bot_name help
@bot_name time
```

### åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ | ä¾‹ |
|---------|------|-----|
| `hello` / `hi` | æŒ¨æ‹¶ã‚’è¿”ã™ | `@bot_name hello` â†’ `Hello!` |
| `help` | åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰ä¸€è¦§ã‚’è¡¨ç¤º | `@bot_name help` |
| `time` | ç¾åœ¨æ™‚åˆ»ã‚’è¿”ã™ | `@bot_name time` â†’ `Current time is: ...` |
| ãã®ä»– | ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä»¥å¤–ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã‚ªã‚¦ãƒ è¿”ã— | `@bot_name ã“ã‚“ã«ã¡ã¯` â†’ `ã“ã‚“ã«ã¡ã¯` |

## âš™ï¸ ç’°å¢ƒå¤‰æ•°

ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’GASã§è¨­å®šã—ã¦ãã ã•ã„ï¼š

```
SLACK_BOT_TOKEN: xoxb-xxxxxxxxxxxx-xxxxxxxxxxxx-xxxxxxxxxxxxxxxxxxxxxxxx
WEBHOOK_SECRET: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx (ä»»æ„)
```

> **âš ï¸ æ³¨æ„**: ãƒˆãƒ¼ã‚¯ãƒ³ã‚„ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã¯çµ¶å¯¾ã«Gitãƒªãƒã‚¸ãƒˆãƒªã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ã§ãã ã•ã„ã€‚

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- **ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†**: Slack Bot Tokenã¯GASã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§å®‰å…¨ã«ç®¡ç†
- **ç½²åæ¤œè¨¼**: `WEBHOOK_SECRET`ã‚’ä½¿ç”¨ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ç½²åæ¤œè¨¼ã‚’å®Ÿè£…å¯èƒ½ï¼ˆç¾åœ¨ã¯ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰
- **ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡**: GASã®ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šã§é©åˆ‡ãªã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’è¨­å®š

## ğŸ“ ã‚³ãƒ¼ãƒ‰ã®æ‹¡å¼µ

`processMessage()` é–¢æ•°ã‚’ç·¨é›†ã™ã‚‹ã“ã¨ã§ã€ç°¡å˜ã«æ–°ã—ã„ã‚³ãƒãƒ³ãƒ‰ã‚’è¿½åŠ ã§ãã¾ã™ï¼š

```javascript
function processMessage(text) {
  const lowerText = text.toLowerCase();

  if (lowerText.includes('hello') || lowerText.includes('hi')) {
    return 'Hello!';
  } else if (lowerText.includes('weather')) {
    return 'Today is sunny!'; // æ–°ã—ã„ã‚³ãƒãƒ³ãƒ‰ã®ä¾‹
  } else if (lowerText.includes('help')) {
    return 'Available commands: hello, help, time, weather';
  } else if (lowerText.includes('time')) {
    return 'Current time is: ' + new Date();
  }

  // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä»¥å¤–ã¯ã‚ªã‚¦ãƒ è¿”ã—ï¼ˆãƒ¡ãƒ³ã‚·ãƒ§ãƒ³éƒ¨åˆ†ã‚’é™¤å»ï¼‰
  return text.replace(/<@[A-Z0-9]+>/g, '').trim();
}
```

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„ issue ã®ä½œæˆã‚’æ­“è¿ã—ã¾ã™ï¼æ”¹å–„ææ¡ˆã‚„ãƒã‚°å ±å‘ŠãŒã‚ã‚Œã°ã€ãŠæ°—è»½ã«ãŠçŸ¥ã‚‰ã›ãã ã•ã„ã€‚

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ”— å‚è€ƒãƒªãƒ³ã‚¯

- [Google Apps Script Documentation](https://developers.google.com/apps-script)
- [Slack API Documentation](https://api.slack.com/)
- [Slack Events API](https://api.slack.com/events-api)

---

<div align="center">

Made with â¤ï¸ using Google Apps Script

</div>
